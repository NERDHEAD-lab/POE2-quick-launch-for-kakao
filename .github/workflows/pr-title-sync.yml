# PR 생성 시 브랜치 이름을 기반으로 제목을 자동 변환합니다. (봇 제외)
name: PR Title Sync

on:
    pull_request:
        types: [opened]

jobs:
    sync-title:
        runs-on: ubuntu-latest
        if: github.event.pull_request.user.type != 'Bot'
        permissions:
            pull-requests: write
        steps:
            - name: Checkout
              uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 # v4.3.1

            - name: Update PR Title
              env:
                  GH_TOKEN: ${{ github.token }}
                  BRANCH_NAME: ${{ github.event.pull_request.head.ref }}
                  PR_NUMBER: ${{ github.event.pull_request.number }}
              run: |
                  if [[ "$BRANCH_NAME" == *"/"* ]]; then
                    PREFIX="${BRANCH_NAME%%/*}"
                    SUFFIX="${BRANCH_NAME#*/}"
                    PREFIX_CAP="$(echo "${PREFIX:0:1}" | tr '[:lower:]' '[:upper:]')${PREFIX:1}"
                    SUFFIX_SPACE="$(echo "$SUFFIX" | sed 's/[-_]/ /g')"
                    NEW_TITLE="$PREFIX_CAP/$SUFFIX_SPACE"
                  else
                    NEW_TITLE="$(echo "${BRANCH_NAME:0:1}" | tr '[:lower:]' '[:upper:]')${BRANCH_NAME:1}"
                    NEW_TITLE="$(echo "$NEW_TITLE" | sed 's/[-_]/ /g')"
                  fi

                  echo "Setting PR title to: $NEW_TITLE"
                  gh pr edit "$PR_NUMBER" --title "$NEW_TITLE"
